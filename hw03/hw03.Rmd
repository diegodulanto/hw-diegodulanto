---
title: "hw03"
author: "Diego A. Dulanto"
date: "2/18/2021"
output:
    html_document: default
    github_document: default
    keep_md: TRUE
    theme: paper
---

# Homework 03

You will analyze data looking at the relationship between **green reputation** and three personality traits--**compassion**, **intellectual curiosity**, and **openness to experiences**.
The dataset includes data from **students** and **non-students**.

```{r setup}
dictionary <- readr::read_csv("green_dictionary.csv")
green_data <- readr::read_csv("green_data.csv")
library(dplyr) 
library(ggplot2)
library(tidyverse)
```

For your assignment, do the following.

  1. Inspect the item responses (e.g., with graphs or by summarizing distinct values). 
     Is anything unusual?
```{r}
green_data %>% 
  summarise(
    across(
      c(green1:student),
      list(Max = ~ max(.x, na.rm = TRUE),
           Min = ~ min(.x, na.rm = TRUE))))

filter(green_data, id == 5549)

dictionary %>% 
  summarize(dictionary)

green_data %>% 
  ggplot() +
  geom_jitter(aes(x = "id", y = "green"))

#There are -99s in the data that needs to be recoded
#There are duplicate data
```     

  2. Compute total scores for the four scales. 
     Recode variables as needed.
```{r}
green_data %>% 
  mutate(
  across(everything(),
 ~ recode(.x , "-99" = NA, .default = .x)))

```
     

  3. Rescale the variables so that they go from 0-100 instead of the original range.
     Name the recaled variables `*_pomp`.
```{r}
reversed <- c("green1", "green2","green3", "green4", 
              "green5" , "comp1", "comp2", "comp3", 
              "comp4", "comp5", "comp6", "comp7", "comp8", "comp9", "comp10", 
              "intel1", "intel2", "intel3", "intel4", "intel5", "intel6",
              "intel7", "intel8", "intel9", "intel10", "open1",
              "open2", "open3", "open4", "open5", "open6", "open7", "open8",
              "open9", "open10")

new_green_data <- green_data %>% 
                    mutate(
                           across(all_of(reversed),
                           ~ recode(.x, "1" = 0, "2" = 25, "4" = 75, "5" = 100))) %>% 
  rowwise() %>% 
  mutate(green_pomp = sum(c
                         (green1,green2,green3,green4,green5), na.rm = TRUE),
         comp_pomp = sum(c
                        (comp1,comp2,comp3,comp4,comp5,comp6,comp7,comp8,comp9,comp10), na.rm = TRUE),
         intel_pomp = sum(c
                         (intel1,intel2,intel3,intel4,intel5,intel6,intel7,intel8,intel9,intel10), na.rm = TRUE),
         open_pomp = sum(c
                        (open1,open2,open3,open4,open5,open6,open7,open8,open9,open10), na.rm = TRUE))

```
     

  4. Make plots that illustrate the distributions of the 4 POMP-scored variables.
```{r Q4 fig2, fig.height = 10, fig.width = 15, fig.align = "center"}
ggplot(new_green_data) +
  aes(x = green_pomp) +
  geom_histogram( fill = "pink")+
  theme_classic()

ggplot(new_green_data) +
  aes(x =intel_pomp) +
  geom_histogram(fill = "green")+
  theme_classic()

ggplot(new_green_data) +
  aes(x = comp_pomp) +
  geom_histogram(fill = "blue")+
  theme_classic()

ggplot(new_green_data) +
  aes(x = open_pomp) +
  geom_histogram(fill = "purple")+
  theme_classic()

 

```


5. Make scatterplots showing the relationships between **green reputation** and each personality trait.
Include trend lines for **students** and **non-students**.
What do these plots show?
```{r}
new_green_data %>%
  mutate(
    student = recode(student , "1" = "Student" , "2" = "NonStudent"))

ggplot(na.omit(new_green_data)) +
  aes( x = green_pomp ,
       y = comp_pomp ,
       fill = student , 
       color = student) +
  geom_point() +
  geom_smooth(data = subset(new_green_data , student == "NonStudent" 
                            | student == "student"))

ggplot(na.omit(new_green_data)) +
  aes( x = green_pomp ,
       y = open_pomp ,
       fill = student , 
       color = student) +
  geom_point() +
  geom_smooth(data = subset(new_green_data , student == "NonStudent" 
                            | student == "student"))

ggplot(na.omit(new_green_data)) +
  aes( x = green_pomp ,
       y = intel_pomp ,
       fill = student , 
       color = student) +
  geom_point() +
  geom_smooth(data = subset(new_green_data , student == "NonStudent" 
                            | student == "student"))
```

  6. Compare **green reputation** for students and non-students using a **rainfall plot** (bar + density + data points).
```{r}
ggplot(na.omit(new_green_data)) +
  aes(x = student , 
      y = green_pomp , 
      color = student) +
  geom_jitter(height = .20)+
  geom_boxplot(color = "green",
               alpha = .5 ,
               width = .1 , 
               size = .5 ) +  
  ggdist::stat_slab(height = .3,
                    color ="green",
                    size = .2 ,
                    alpha = .5 ,
                    position = position_nudge( y = .5))

#Overall, the plot does not seem to indicate a notable difference between students and non-students for the green reputation scale. 
#However, the plot seems to show that students seem to have larger variance and a lower mean.

```
  

  7. Compute a summary table of means, SDs, medians, minima, and maxima for the four total scores for students and non-students.
```{r}
Q7 <- Q5 %>%
  group_by(student) %>% 
  summarize(across(c(Total_green:Total_open),
                    list(Mu = ~ mean(.x, na.rm = TRUE),
                         Sigma = ~ sd(.x, na.rm = TRUE),
                         Median = ~ median(.x, na.rm = TRUE),
                         Max = ~ max(.x, na.rm = TRUE),
                         Min = ~ min(.x, na.rm = TRUE))))

Q7.1 <- as.data.frame(t(as.matrix(Q7)))

Q7.1

```
  

  
In your assignment, prepare an RMarkdown file that includes both the coding and (for 4-7) narrative descriptions of your results.
