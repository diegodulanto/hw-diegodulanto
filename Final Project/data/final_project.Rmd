---
title: "hw04"
author: "Diego A. Dulanto"
date: "`r format(Sys.Date(), '%b %d %Y')`"
output:
    html_document:
        theme: paper
    github_document: default
editor_options: 
  chunk_output_type: console
  
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

## Final Project Introduction

This project is an objective view into migration patterns from 1999-2000, specifically from South America.

The data collected is from the national, public database of the United States Department of Justice. Immigration and Naturalization Service. I will be cleaning the data, creating summaries of the data, and displaying the difference between 1999 and 2000 using visual aids.

```{r load packages, include=FALSE}
library(haven)
library(tidyverse)
library(ggplot2)
library(readr)
library(tibble)
library(ggdist)
library(gridExtra)
library(devtools)
library(naniar)
library(reshape2)
library(scales)
```



```{r import data}
here::here("data", "immigrant_data_2000.sav")

(immigrant_data <- haven::read_sav(
  here::here("Final Project", "data", "immigrant_data_2000.sav")
)
)
```

## Data Cleaning
First, I will be renaming the variables from the dataset. Right now, the dataset uses variables named V# (i.e., V1, V2, V3, etc.). I will be renaming the variables as such:

V1 - Month of Admission

V2 - Year of Admission

V3 - Country of Birth

V4 - Age

V5 - Country of Last Permanent Residence

V6 - Marital Status

V7 - State of Intended Residence

V8 - Metropolitan Area of Intended Residence

V9 - Labor Certification

v10 - Occupation

V11 - Sex

V12 - Country of Chargeability

v13 - Type of Case

V14 - Nonimmigrant Class of Entry

V15 - Nonimmigrant Year of Entry

V16 - Immigrant Class of Admission

v17 - Prinicipal Vs Derivative Class of Admission

The code for renaming the variables is below.


```{r}
## Renaming columns

colnames(immigrant_data)[colnames(immigrant_data) == "V1"] <- "Month_of_Admission"
colnames(immigrant_data)[colnames(immigrant_data) == "V2"] <- "Year_of_Admission"
colnames(immigrant_data)[colnames(immigrant_data) == "V3"] <- "Country_of_Birth"
colnames(immigrant_data)[colnames(immigrant_data) == "V4"] <- "Age"
colnames(immigrant_data)[colnames(immigrant_data) == "V5"] <- "Country_of_Last_Permanent_Residence"
colnames(immigrant_data)[colnames(immigrant_data) == "V6"] <- "Marital_Status"
colnames(immigrant_data)[colnames(immigrant_data) == "V7"] <- "State_of_Intended_Residence"
colnames(immigrant_data)[colnames(immigrant_data) == "V8"] <- "Metropolitan_Area_of_Intended_Residence"
colnames(immigrant_data)[colnames(immigrant_data) == "V9"] <- "Labor_Certification"
colnames(immigrant_data)[colnames(immigrant_data) == "V10"] <- "Occupation"
colnames(immigrant_data)[colnames(immigrant_data) == "V11"] <- "Sex"
colnames(immigrant_data)[colnames(immigrant_data) == "V12"] <- "Country_of_Chargeability"
colnames(immigrant_data)[colnames(immigrant_data) == "V13"] <- "Type_of_Case"
colnames(immigrant_data)[colnames(immigrant_data) == "V14"] <- "Nonimmigrant_Class_of_Entry"
colnames(immigrant_data)[colnames(immigrant_data) == "V15"] <- "Nonimmigrant_Year_of_Entry"
colnames(immigrant_data)[colnames(immigrant_data) == "V16"] <- "Immigrant_Class_of_Admission"
colnames(immigrant_data)[colnames(immigrant_data) == "V17"] <- "Principal_Vs_Derivative_Class_of_Admission"


print(immigrant_data)

```


```{r summary, echo=TRUE}
# Summarizing Data

peru_averages <- immigrant_data %>%
  rowwise() %>%
  summarise(Month_of_Admission, Country_of_Birth, Age) %>%
  filter(Country_of_Birth == 224, na.rm=FALSE) %>%
  mutate(
    mean(Month_of_Admission, na.rm=FALSE),
    mean(Age, na.rm=FALSE)
  )

print(peru_averages)
```



```{r}
# Plotting Data

immigrant_data

# WDG: Great you've created the col_types; however, its not applied to the data.
col_types <- cols(
  "Month_of_Admission" = col_double(),
  "Year_of_Admission" = col_double(),
  "Country_of_Birth" = col_double(),
  "Age" = col_double(),
  "Country_of_Last_Permanent_Residence" = col_character(),
  "Marital_Status" = col_double(),
  "State_of_Intended_Residence" = col_double(),
  "Metropolitan_Area_of_Intended_Residence" = col_double(),
  "Labor_Certification" = col_double(),
  "Occupation" = col_double(),
  "Sex" = col_double(),
  "Country_of_Chargeability" = col_double(),
  "Type_of_Case" = col_double(),
  "Nonimmigrant_Class_of_Entry" = col_double(),
  "Nonimmigrant_Year_of_Entry" = col_double(),
  "Immigrant_Class_of_Admission" = col_double(),
  "Principal_Vs_Derivative_Class_of_Admission" = col_double()
)



# WDG: A title is very important when it comes to graphs. Try and answer the question: "What am I looking at?" when thinking of a title.
immigrant_data %>%
  select("Month_of_Admission", "Country_of_Birth") %>%
  ggplot() +
  aes(x = "Month_of_Admission", y = "Country_of_Birth") +
  geom_point(alpha = .05) +
  theme_classic()
```
